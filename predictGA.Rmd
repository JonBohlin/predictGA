---
title: "predictGA"
author: "Jon Bohlin"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction
predictGA is a R function that facilitates prediction of gestational age from blood based on the Illumina HumanMethylation450 arrays. At it's core is a trained Lasso-regression glmnet-model that takes a matrix of beta values between 0 and 1 and uses these to infer gestational age. To see how it works we provide a simple example with a mock-dataset.


```{r predictGA}
require(predictGA)
cpgs=extractSites(type="se")
allcpgs=extractSites(type="all")
numsamples=100
mlmatr=matrix(NA, ncol=length(allcpgs), nrow=numsamples)
mlmatr=data.frame(mlmatr)
for(i in cpgs)
  mlmatr[,i]=runif(numsamples, min=0, max=1)
```

## Details
The glmnet Lasso-regression object requires a set of CpG sites to function. There are two similar models that can be chosen for gestational age prediction. The first (and default) sets the Lasso penalty parameter lambda to be within one standard error of minimum. The second model uses the minimum lambda. While the latter of these two models might give slightly improved predictions the former requires fewer CpGs to estimate gestational age but the quality of the predictions are almost the same as the latter model assuming the minimum penalty parameter lambda.


```{r predictGA2}
mypred=predictGA(mlmatr)
head(mypred)
```

## Requirement
The CpGs required for predictGA must be fully compliant with the Illumina HumanMethylation450 arrays otherwise the function will not work. To examine which CpGs are essential for prediction have a look at the extractSites() function:


```{r extractSites}
cpgs=extractSites(type="se")
cpgs[1:10]
```
